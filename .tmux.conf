unbind-key r
bind-key r source-file ~/.tmux.conf; display-message "~/.tmux.conf is reloaded"

unbind-key C-b
set -g prefix 'C-\'
bind-key 'C-\' send-prefix

set-option -g default-shell /bin/zsh

set -g pane-border-lines 'double'

bind q display-menu -t . -T "Fast command menu" \
    "Connect VPN"                   b    "new-session -A -s vpn\; send -t vpn \"connect_vpn\" ENTER\;  switch-client -l  " \
    "" \
    "Rotate clockwise"              r    "swap-pane -U" \
    "Rotate counter-clockwise"      R    "swap-pane -D" \
################################## PLUGINS #################################
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'pschmitt/tmux-ssh-split'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'sainnhe/tmux-fzf'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'MunifTanjim/tmux-mode-indicator'

#============ tmux-continuum ===============
set -g @continuum-restore 'on'
set -g @continuum-save-interval '5'

#============ usefull popup windows =====================
# find all links in current pane and search them with fzf
bind u display-popup -E -B  "tmux capture-pane -J -p -E 10000  | grep -oE '(https?):\/\/.*[^>]' | fzf --reverse --height 100% -d20 --multi --bind alt-a:select-all,alt-d:deselect-all --border-label 'Open link in browser' | xargs open"

# open a popup to choose and switch to another open session
bind f display-popup -E -B  "tmux ls -F '#{session_name}' \
                          | grep -v $(tmux display-message -p '#S') \
                          | sort \
                          | fzf --height 100% --reverse --border-label 'Change session' \
                          | xargs -r tmux switch -t"

# opens lazygit in current pane directory as a popup
bind g display-popup -w 90% -h 90% "zsh -l -c 'cd $(tmux display-message -p \"#{pane_current_path}\") && lazygit'" 

# opens ranger file manager in current directory as a popup
bind b display-popup -E -w 90% -h 90% -b rounded -T 'File manager' "ranger $(tmux display-message -p '#{pane_current_path}')" 

# open htop in a popup
bind t display-popup -E -w 90% -h 90% -b rounded -T 'htop' "htop" 

set -g @plugin 'rose-pine/tmux'
set -g @rose_pine_variant 'main'

set -g @rose_pine_status_right_prepend_section "#{tmux_mode_indicator}"

#set -g @rose_pine_bar_bg_disable "on"
#set-option -g status-style bg=default

#k bar sections
#set -g @rose_pine_user 'on'
#set -g @rose_pine_date_time '%d/%m/%Y %H:%M:%S'
#set -g @rose_pine_host 'on'
#set -g @rose_pine_directory 'on'
# set -g @rose_pine_pane_directory 'on'

# bar separators
set -g @rose_pine_right_separator ' '
set -g @rose_pine_left_separator ' '
set -g @rose_pine_window_status_separator " | " # Changes the default icon that appears between window names

# bar icons
set -g @rose_pine_session_icon '' # Changes the default icon to the left of the session name
set -g @rose_pine_current_window_icon '' # Changes the default icon to the left of the active window name
set -g @rose_pine_folder_icon '' # Changes the default icon to the left of the current directory folder
set -g @rose_pine_username_icon '  ' # Changes the default icon to the right of the hostname
set -g @rose_pine_hostname_icon '  '  # Changes the default icon to the right of the hostname
set -g @rose_pine_date_time_icon '   ' # Changes the default icon to the right of the date gRdule

set -g @ssh-split-keep-cwd "true"
set -g @ssh-split-keep-remote-cwd "true"
set -g @ssh-split-h-key "H"
set -g @ssh-split-v-key "S"
set -g @ssh-split-w-key "C"

################################ OPTIONS ######################################
set -g status-position top
set -g mouse on
set -g set-clipboard on

setw mode-style "fg=default,bg=default,reverse"
#setw window-style 'bg=colour253'
set -g @yank_action "copy-pipe"

# use these options to display correct colors in neovim
set -g default-terminal 'xterm-256color'
set -ag terminal-overrides ",xterm-256color*:Tc"


bind  c  new-window      -c "#{pane_current_path}"
bind  %  split-window -h -c "#{pane_current_path}"
bind '"' split-window -v -c "#{pane_current_path}"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
